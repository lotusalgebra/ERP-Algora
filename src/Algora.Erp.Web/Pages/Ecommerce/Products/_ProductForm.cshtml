@model Algora.Erp.Web.Pages.Ecommerce.Products.EcommerceProductFormViewModel

<form hx-post="?handler="
      hx-target="#productsTableBody"
      hx-on::after-request="if(event.detail.successful) document.body.dispatchEvent(new Event('formSubmitSuccess'))">

    @if (Model.IsEdit)
    {
        <input type="hidden" name="Id" value="@Model.Product?.Id" />
    }

    <div class="grid grid-cols-12 gap-6">
        <!-- Left Column - Main Info -->
        <div class="col-span-12 md:col-span-8">
            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900">Product Name <span class="text-red-500">*</span></label>
                <input type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Name" value="@Model.Product?.Name" required />
            </div>

            <div class="grid grid-cols-12 gap-4 mb-4">
                <div class="col-span-12 md:col-span-6">
                    <label class="block mb-2 text-sm font-medium text-gray-900">SKU <span class="text-red-500">*</span></label>
                    <input type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Sku" value="@Model.Product?.Sku" required />
                </div>
                <div class="col-span-12 md:col-span-6">
                    <label class="block mb-2 text-sm font-medium text-gray-900">URL Slug</label>
                    <input type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Slug" value="@Model.Product?.Slug" placeholder="auto-generated-from-name" />
                </div>
            </div>

            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900">Short Description</label>
                <textarea class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="ShortDescription" rows="2">@Model.Product?.ShortDescription</textarea>
            </div>

            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900">Full Description</label>
                <textarea class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Description" rows="5">@Model.Product?.Description</textarea>
            </div>

            <!-- Pricing -->
            <h6 class="border-b border-gray-200 pb-2 mb-4 mt-6 font-semibold text-gray-900">Pricing</h6>
            <div class="grid grid-cols-12 gap-4 mb-4">
                <div class="col-span-12 md:col-span-4">
                    <label class="block mb-2 text-sm font-medium text-gray-900">Price <span class="text-red-500">*</span></label>
                    <div class="flex">
                        <span class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border rounded-e-0 border-gray-300 border-e-0 rounded-s-md">$</span>
                        <input type="number" step="0.01" class="rounded-none rounded-e-lg bg-gray-50 border border-gray-300 text-gray-900 text-sm focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Price" value="@Model.Product?.Price.ToString("F2")" required />
                    </div>
                </div>
                <div class="col-span-12 md:col-span-4">
                    <label class="block mb-2 text-sm font-medium text-gray-900">Compare At Price</label>
                    <div class="flex">
                        <span class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border rounded-e-0 border-gray-300 border-e-0 rounded-s-md">$</span>
                        <input type="number" step="0.01" class="rounded-none rounded-e-lg bg-gray-50 border border-gray-300 text-gray-900 text-sm focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="CompareAtPrice" value="@Model.Product?.CompareAtPrice?.ToString("F2")" />
                    </div>
                    <small class="text-gray-500 text-xs">Original price for sale items</small>
                </div>
                <div class="col-span-12 md:col-span-4">
                    <label class="block mb-2 text-sm font-medium text-gray-900">Cost Price</label>
                    <div class="flex">
                        <span class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border rounded-e-0 border-gray-300 border-e-0 rounded-s-md">$</span>
                        <input type="number" step="0.01" class="rounded-none rounded-e-lg bg-gray-50 border border-gray-300 text-gray-900 text-sm focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="CostPrice" value="@Model.Product?.CostPrice?.ToString("F2")" />
                    </div>
                </div>
            </div>

            <!-- Inventory -->
            <h6 class="border-b border-gray-200 pb-2 mb-4 mt-6 font-semibold text-gray-900">Inventory</h6>
            <div class="grid grid-cols-12 gap-4 mb-4">
                <div class="col-span-12 md:col-span-4 flex items-center">
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="sr-only peer" name="TrackInventory" value="true"
                               @(Model.Product?.TrackInventory ?? true ? "checked" : "") id="trackInventory">
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600"></div>
                        <span class="ms-3 text-sm font-medium text-gray-900">Track Inventory</span>
                    </label>
                </div>
                <div class="col-span-12 md:col-span-4">
                    <label class="block mb-2 text-sm font-medium text-gray-900">Stock Quantity</label>
                    <input type="number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="StockQuantity" value="@(Model.Product?.StockQuantity ?? 0)" />
                </div>
                <div class="col-span-12 md:col-span-4">
                    <label class="block mb-2 text-sm font-medium text-gray-900">Low Stock Threshold</label>
                    <input type="number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="LowStockThreshold" value="@(Model.Product?.LowStockThreshold ?? 5)" />
                </div>
            </div>
            <div class="mb-4">
                <label class="inline-flex items-center cursor-pointer">
                    <input type="checkbox" class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2" name="AllowBackorder" value="true"
                           @(Model.Product?.AllowBackorder == true ? "checked" : "") id="allowBackorder" />
                    <span class="ms-2 text-sm font-medium text-gray-900">Allow backorders when out of stock</span>
                </label>
            </div>

            <!-- SEO -->
            <h6 class="border-b border-gray-200 pb-2 mb-4 mt-6 font-semibold text-gray-900">SEO</h6>
            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900">Meta Title</label>
                <input type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="MetaTitle" value="@Model.Product?.MetaTitle" />
            </div>
            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900">Meta Description</label>
                <textarea class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="MetaDescription" rows="2">@Model.Product?.MetaDescription</textarea>
            </div>
            <div class="mb-4">
                <label class="block mb-2 text-sm font-medium text-gray-900">Tags</label>
                <input type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Tags" value="@Model.Product?.Tags" placeholder="summer, sale, new" />
                <small class="text-gray-500 text-xs">Comma-separated tags</small>
            </div>
        </div>

        <!-- Right Column - Organization & Status -->
        <div class="col-span-12 md:col-span-4">
            <div class="bg-gray-50 rounded-lg p-4 mb-4">
                <h6 class="font-semibold text-gray-900 mb-3">Status</h6>
                <select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Status">
                    @if (Model.Product?.Status == Algora.Erp.Domain.Entities.Ecommerce.ProductStatus.Draft)
                    {
                        <option value="Draft" selected>Draft</option>
                    }
                    else
                    {
                        <option value="Draft">Draft</option>
                    }
                    @if (Model.Product?.Status == Algora.Erp.Domain.Entities.Ecommerce.ProductStatus.Active)
                    {
                        <option value="Active" selected>Active</option>
                    }
                    else
                    {
                        <option value="Active">Active</option>
                    }
                    @if (Model.Product?.Status == Algora.Erp.Domain.Entities.Ecommerce.ProductStatus.Archived)
                    {
                        <option value="Archived" selected>Archived</option>
                    }
                    else
                    {
                        <option value="Archived">Archived</option>
                    }
                </select>
            </div>

            <div class="bg-gray-50 rounded-lg p-4 mb-4">
                <h6 class="font-semibold text-gray-900 mb-3">Organization</h6>
                <div class="mb-4">
                    <label class="block mb-2 text-sm font-medium text-gray-900">Category</label>
                    <select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="CategoryId">
                        <option value="">-- Select Category --</option>
                        @foreach (var category in Model.Categories)
                        {
                            if (Model.Product?.CategoryId == category.Id)
                            {
                                <option value="@category.Id" selected>@category.Name</option>
                            }
                            else
                            {
                                <option value="@category.Id">@category.Name</option>
                            }
                        }
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block mb-2 text-sm font-medium text-gray-900">Brand</label>
                    <input type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Brand" value="@Model.Product?.Brand" />
                </div>
                <div class="mb-4">
                    <label class="block mb-2 text-sm font-medium text-gray-900">Vendor</label>
                    <input type="text" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Vendor" value="@Model.Product?.Vendor" />
                </div>
            </div>

            <div class="bg-gray-50 rounded-lg p-4 mb-4">
                <h6 class="font-semibold text-gray-900 mb-3">Shipping</h6>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block mb-2 text-sm font-medium text-gray-900">Weight</label>
                        <input type="number" step="0.01" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="Weight" value="@Model.Product?.Weight?.ToString("F2")" />
                    </div>
                    <div>
                        <label class="block mb-2 text-sm font-medium text-gray-900">Unit</label>
                        <select class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5" name="WeightUnit">
                            @{
                                var weightUnit = Model.Product?.WeightUnit ?? "kg";
                            }
                            @if (weightUnit == "kg") { <option value="kg" selected>kg</option> } else { <option value="kg">kg</option> }
                            @if (weightUnit == "lb") { <option value="lb" selected>lb</option> } else { <option value="lb">lb</option> }
                            @if (weightUnit == "oz") { <option value="oz" selected>oz</option> } else { <option value="oz">oz</option> }
                            @if (weightUnit == "g") { <option value="g" selected>g</option> } else { <option value="g">g</option> }
                        </select>
                    </div>
                </div>
            </div>

            <div class="bg-gray-50 rounded-lg p-4">
                <h6 class="font-semibold text-gray-900 mb-3">Product Badges</h6>
                <div class="mb-3">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2" name="IsFeatured" value="true"
                               @(Model.Product?.IsFeatured == true ? "checked" : "") id="isFeatured" />
                        <span class="ms-2 text-sm font-medium text-gray-900">
                            <i class="bi bi-star-fill text-amber-500 mr-1"></i>Featured Product
                        </span>
                    </label>
                </div>
                <div class="mb-3">
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2" name="IsNewArrival" value="true"
                               @(Model.Product?.IsNewArrival == true ? "checked" : "") id="isNewArrival" />
                        <span class="ms-2 text-sm font-medium text-gray-900">
                            <i class="bi bi-tag-fill text-blue-500 mr-1"></i>New Arrival
                        </span>
                    </label>
                </div>
                <div>
                    <label class="inline-flex items-center cursor-pointer">
                        <input type="checkbox" class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2" name="IsBestSeller" value="true"
                               @(Model.Product?.IsBestSeller == true ? "checked" : "") id="isBestSeller" />
                        <span class="ms-2 text-sm font-medium text-gray-900">
                            <i class="bi bi-trophy-fill text-emerald-500 mr-1"></i>Best Seller
                        </span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="flex items-center justify-end p-4 border-t border-gray-200 rounded-b gap-2 mt-6">
        <button type="button" class="text-gray-900 bg-white border border-gray-300 hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5" onclick="closeModal('formModal')">Cancel</button>
        <button type="submit" class="text-white bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5">
            <i class="bi bi-check-lg mr-2"></i>@(Model.IsEdit ? "Update" : "Create") Product
        </button>
    </div>
</form>
